# OpenJDK 17을 사용하는 이미지 기반
FROM openjdk:17-jdk-slim

ARG SPRING_DATASOURCE_URL
ARG SPRING_DATASOURCE_USERNAME
ARG SPRING_DATASOURCE_PASSWORD
ARG AWS_ACCESS_KEY_ID
ARG AWS_SECRET_ACCESS_KEY
ARG JWT_SECRET

# 환경 변수 설정
ENV SPRING_DATASOURCE_URL=jdbc:mysql://mysql-container:3306/rosewar_scoretracker
ENV SPRING_DATASOURCE_USERNAME=${SPRING_DATASOURCE_USERNAME}
ENV SPRING_DATASOURCE_PASSWORD=${SPRING_DATASOURCE_PASSWORD}
ENV AWS_ACCESS_KEY_ID=${AWS_ACCESS_KEY_ID}
ENV AWS_SECRET_ACCESS_KEY=${AWS_SECRET_ACCESS_KEY}
ENV JWT_SECRET=${JWT_SECRET}

# 로컬에서 업로드한 JAR 파일을 컨테이너의 /app 폴더로 복사
COPY scoretracker-0.0.1-SNAPSHOT.jar /app/scoretracker.jar

# 작업 디렉토리 설정
WORKDIR /app

# 애플리케이션 실행
CMD ["java", "-jar", "scoretracker.jar"]
